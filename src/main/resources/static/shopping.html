<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
	<title>居家风水</title>
	<link href="css/style.css" rel="stylesheet" type="text/css" />
	<link href="css/occupyHome.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" type="text/css" href="css/shopping.css" />

	<script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/quick_links.js"></script>
	<script type="text/javascript" src="js/scroll.js"></script>
	<script type="text/javascript" src="js/headerLi.js"></script>
</head>
<body>
<header>
	<div class="header_logo">
		<div class="header_logo_left">
			易经风水
		</div>
		<div class="header_logo_right2">
			<img src="images/index/header_logo2.png">
		</div>
	</div>
</header>
	<!--<iframe MARGINWIDTH=0 MARGINHEIGHT=0 HSPACE=0 VSPACE=0 FRAMEBORDER=0 SCROLLING=no src="header.html" width="100%" height="160px"></iframe>-->
	<nav>
	<div class="nav_list" id="nav_list">
		<ul class="nav_menu">
			<li><a href="index.html">官网首页</a></li>
			<li><a href="name.html">择吉取名</a></li>
			<li><a href="occupyHome.html">家居风水</a></li>
			<li><a href="enterprise.html">企业风水</a></li>
			<li><a href="shopping.html" style="color: red;">吉祥用品</a></li>
			<li><a href="shopping.html">风水工艺品</a></li>
			<li><a href="">风水知识</a></li>
			<li><a href="case.html">服务案例</a></li>
			<li><a href="aboutUs.html">结缘大师</a></li>
		</ul>
	</div>
	</nav>
	
	<!--左侧产品parabola.js控制-->
	<div class="main">
		<div id="plist">
			<ul>
				<li>
					<div id="product_div_1" class="lh_wrap">
						<input hidden="true" value="300" id="price_1"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品1"
								src="images/product/1.jpg"
								title="入驻商家测试商品3" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品1">商品1</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('1');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_4" class="lh_wrap">
						<input hidden="true" value="300" id="price_4"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品4"
								src="images/product/4.jpg"
								title="入驻商家测试商品4" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品4">商品4</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('4');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_3" class="lh_wrap">
						<input hidden="true" value="300" id="price_3"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品3"
								src="images/product/3.jpg"
								title="入驻商家测试商品2" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品3">商品3</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('3');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_5" class="lh_wrap">
						<input hidden="true" value="300" id="price_5"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品5"
								src="images/product/5.jpg"
								title="入驻商家测试商品3" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品5">商品5</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('5');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_6" class="lh_wrap">
						<input hidden="true" value="300" id="price_6"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品6"
								src="images/product/6.jpg"
								title="入驻商家测试商品6" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品6">商品6</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('6');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_7" class="lh_wrap">
						<input hidden="true" value="300" id="price_7"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品7"
								src="images/product/7.jpg"
								title="入驻商家测试商品3" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品7">商品7</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('7');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
				<li>
					<div id="product_div_2" class="lh_wrap">
						<input hidden="true" value="300" id="price_2"/>
						<div class="p-img">
							<a href="#"><img alt="入驻商家测试商品2"
								src="images/product/2.jpg"
								title="入驻商家测试商品2" width="240"></a>
						</div>
						<div class="p-name">
							<a href="#" title="商品2">商品2</a>
						</div>
						<div class="p-price">
							<strong>￥300</strong><span id="p200"></span>
						</div>
						<div class="btns">
							<a href="javascript:addProductToCart('2');" class="add_cart_large btn_cart">加入购物车</a> 
					</div>
				</li>
				
			</ul>
		</div>
		<div id="flyItem" class="fly_item">
			<img src="images/shopping/item-pic.jpg" width="40" height="40">
		</div>
	</div>

	<!--右侧贴边导航quick_links.js控制-->
	<div class="mui-mbar-tabs">
		<div class="quick_link_mian">
			<div class="quick_links_panel">
				<div id="quick_links" class="quick_links">
					<li id="shopCart"><a href="#" class="message_list"><i
							class="message"></i>
							<div class="span">购物车</div> <span class="cart_num">0</span></a></li>
				</div>
				<div class="quick_toggle">
					<li><a href="#top" class="return_top"><i class="top"></i></a></li>
				</div>
			</div>
			<div id="quick_links_pop" class="quick_links_pop hide"></div>
		</div>
	</div>


	<!--[if lte IE 8]>
<script src="js/ieBetter.js"></script>
<![endif]-->

	<script type="text/javascript" src="js/parabola.js"></script>
	<script type="text/javascript">
		var initTotalCount = ds.getCookie("totalCount");
		if(isNaN(initTotalCount) || initTotalCount == ''){
			initTotalCount = 0;
		}
		$('.cart_num').html(initTotalCount);
		
		function deleteFromCart(obj){
			var product_id = $(obj).attr('product_id');

			var totalPrice = parseFloat(ds.getCookie("totalPrice"));
			var totalCount = parseInt(ds.getCookie("totalCount"));
			if(isNaN(totalPrice)){
				totalPrice = 0;
				totalCount = 0;
			}
			
			var productCookie = ds.getCookie("productJSON");
			var productJSON = [];
			if(productCookie != undefined && productCookie != ''){
				productJSON = JSON.parse(productCookie);
			}
			
			var copyProductJSON = [];
			var totalJSONSize = productJSON.length;
			for (var i = 0; i < totalJSONSize; i++) {
				var product = productJSON.pop();
				if(product.imageName == product_id){
					totalCount = totalCount - parseInt(product.count);
					totalPrice = totalPrice - (parseFloat(product.price) * parseInt(product.count));
					break;
				}
				copyProductJSON.push(product);
			}
			for (var i = 0; i < copyProductJSON.length; i++) {
				productJSON.push(copyProductJSON[i]);
			}

			ds.setCookie("totalCount", totalCount, 30);
			ds.setCookie("totalPrice", totalPrice, 30);
			ds.setCookie("productJSON", JSON.stringify(productJSON), 30);

			$(obj).parent().parent().remove();
			$('.cart_handler_left .cart_price').html(totalCount);
			$('.cart_num').html(totalCount);
			$('#price').html('￥'+totalPrice);
		};
		
		function addProductToCart(productId){
			var productCookie = ds.getCookie("productJSON");
			var productJSON = [];
			if(productCookie != undefined && productCookie != ''){
				productJSON = JSON.parse(productCookie);
			}

			var productName = $('#product_div_' + productId).find('.p-name a').html();
			var imageName = productId;
			var count = 1;
			var price = parseFloat($('#price_' + productId).val());
			
			if(productJSON.length == 0){
				var row = {};
				row.productName = productName;
				row.imageName = imageName;
				row.count = count;
				row.price = price;
				productJSON.push(row);
			}else{
				var exists = false;
				for(var i = 0 ; i < productJSON.length ; i ++){
					if(productJSON[i].productName == productName){
						exists = true;
						productJSON[i].count = parseInt(productJSON[i].count) + 1;
					}
				}
				if(!exists){
					var row = {};
					row.productName = productName;
					row.imageName = imageName;
					row.count = count;
					row.price = price;
					productJSON.push(row);
				}
			}
			
			var totalPrice = parseFloat(ds.getCookie("totalPrice"));
			var totalCount = parseInt(ds.getCookie("totalCount"));
			if(isNaN(totalPrice)){
				totalPrice = 0;
				totalCount = 0;
			}
			totalPrice = totalPrice + price;
			totalCount = totalCount + count;
			$('.cart_num').html(totalCount);
			
			ds.setCookie("totalCount", totalCount, 30);
			ds.setCookie("totalPrice", totalPrice, 30);
			ds.setCookie("productJSON", JSON.stringify(productJSON), 30);
		};
	
		$(".quick_links_panel li").mouseenter(function() {
			$(this).children(".mp_tooltip").animate({
				left : -92,
				queue : true
			});
			$(this).children(".mp_tooltip").css("visibility", "visible");
			$(this).children(".ibar_login_box").css("display", "block");
		});
		$(".quick_links_panel li").mouseleave(function() {
			$(this).children(".mp_tooltip").css("visibility", "hidden");
			$(this).children(".mp_tooltip").animate({
				left : -121,
				queue : true
			});
			$(this).children(".ibar_login_box").css("display", "none");
		});
		$(".quick_toggle li").mouseover(function() {
			$(this).children(".mp_qrcode").show();
		});
		$(".quick_toggle li").mouseleave(function() {
			$(this).children(".mp_qrcode").hide();
		});

		// 元素以及其他一些变量
		var eleFlyElement = document.querySelector("#flyItem"), eleShopCart = document
				.querySelector("#shopCart");
		var numberItem = 0;
		// 抛物线运动
		var myParabola = funParabola(eleFlyElement, eleShopCart, {
			speed : 400, //抛物线速度
			curvature : 0.0008, //控制抛物线弧度
			complete : function() {
				eleFlyElement.style.visibility = "hidden";
			}
		});
		// 绑定点击事件
		if (eleFlyElement && eleShopCart) {

			[].slice
					.call(document.getElementsByClassName("btn_cart"))
					.forEach(
							function(button) {
								button
										.addEventListener(
												"click",
												function(event) {
													// 滚动大小
													var scrollLeft = document.documentElement.scrollLeft
															|| document.body.scrollLeft
															|| 0, scrollTop = document.documentElement.scrollTop
															|| document.body.scrollTop
															|| 0;
													eleFlyElement.style.left = event.clientX
															+ scrollLeft + "px";
													eleFlyElement.style.top = event.clientY
															+ scrollTop + "px";
													eleFlyElement.style.visibility = "visible";

													// 需要重定位
													myParabola.position()
															.move();
												});
							});
		}
	</script>

</body>
</html>